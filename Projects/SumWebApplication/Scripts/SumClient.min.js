var serverConfig={servers:[],registerServer:function(n,t,i){var r=new Server(n,t,i);return r.initReadServiceListener(),r.initWriteServiceListener(),this.servers.push(r),r},sendDataForAllServers:function(){jQuery.each(this.servers,function(n,t){if(t.readWSClient().readyState==WebSocket.OPEN){var i=tools.getRandom(0,30);t.readWSClient().send(i);tools.logToConsole("Sending data: "+i+" to read server...")}})},disconectAllChanels:function(){jQuery.each(this.servers,function(n,t){var i=tools.getRandom(0,30);t.readWSClient().close()})}},tools={getRandom:function(n,t){return pos=t-n,mRan=Math.random()*pos,mRan=Math.floor(mRan),parseInt(n)+mRan},logToConsole:function(n){console.log(n)},getCanvasContext:function(){var n=document.getElementById("sumCanvas");return n.getContext("2d")},printLine:function(n,t,i,r,u){var f=this.getCanvasContext(),o,e;f.font="10px Arial";f.fillStyle="#663366";f.strokeStyle=u;f.beginPath();o=40+i*14;o>860?f.moveTo(40,560-r*10):f.moveTo(40+i*14,560-r*10);f.lineTo(40+n*14,560-t*10);f.stroke();f.fillText(t.toString(),40+n*14,555-t*10);n>=59&&(f.clearRect(0,0,900,600),initCanvas());e="x: "+n.toString();e+="<\/br>y: "+t.toString();e+="<\/br> last x:"+i;e+="<\/br> last y: "+r;e+="<\/br> color: "+u;jQuery("#console").html(e)}},Server=function(n,t,i){var u=null,r=null;this.LastY=0;this.LastX=10;this.ReadPort=n;this.WritePort=t;this.ServerLineColor=i;this.ReadURL=function(){return"ws://localhost:"+this.ReadPort+"/SumServer/ReadData"};this.WriteURL=function(){return"ws://localhost:"+this.WritePort+"/SumServer/WriteData"};this.initReadServiceListener=function(){u==null&&(u=new WebSocket(this.ReadURL()),this.configReadWS())};this.initWriteServiceListener=function(){r==null&&(r=new WebSocket(this.WriteURL()),this.configWriteWS())};this.readWSClient=function(){return u==null&&(u=new WebSocket(this.ReadURL()),this.configReadWS()),u};this.writeWSClient=function(){return r==null&&(r=new WebSocket(this.WriteURL()),this.configWriteWS()),r};this.configReadWS=function(){var n=this.ReadPort;u.onopen=function(){tools.logToConsole("Port: "+n+" is open.")};u.onerror=function(){tools.logToConsole("Port: "+n+" handled error!!!")};u.onclose=function(){tools.logToConsole("Port: "+n+" is disconected.")}};this.configWriteWS=function(){var n=this.WritePort,u=this.ServerLineColor,t=this.LastX,i=this.LastY;r.onmessage=function(r){tools.logToConsole("Server in port: "+n+" says:"+r.data);var e=new Date,f=e.getSeconds();tools.printLine(f>60?0:f,r.data,t,i,u);t=f>=60?0:f;i=r.data;console.log(r.data)};r.onopen=function(){r.send("Ready!!!");tools.logToConsole("Port: "+n+" is open.")};r.onerror=function(){tools.logToConsole("Port: "+n+" handled error!!!")}};this.get_lastCoords=function(){return{lastX:this.LastX,lastY:this.LastY}}},initCanvas,buildSeries;jQuery().ready(function(){jQuery("#cmdOpenServerConfigPanel").click(function(n){n.preventDefault();n.stopPropagation();jQuery("#serverConfigPanel").removeClass("hidden");jQuery.blockUI({message:$("#serverConfigPanel")})});jQuery("#txtReadServerPort").change(function(){jQuery("#lblReadServerURI").html("Server Url: http://localhost:"+jQuery(this).val()+"/SumServer/ReadData")});jQuery("#txtWriteServerPort").change(function(){jQuery("#lblWriteServerURI").html("Server Url: http://localhost:"+jQuery(this).val()+"/SumServer/WriteData")});jQuery("#cmdAddServer").click(function(n){var t,i;if(n.preventDefault(),n.stopPropagation(),t=document.getElementById("txtReadServerPort").validity,!t.valid){alert("Sorry, the read server port is invalid");return}if(i=document.getElementById("txtWriteServerPort").validity,!i.valid){alert("Sorry, the write server port is invalid");return}var r=jQuery("#txtReadServerPort").val(),u=jQuery("#txtWriteServerPort").val(),f=jQuery("#serverLineColor").val();serverConfig.registerServer(r,u,f);jQuery("#txtReadServerPort").val(null);jQuery("#txtWriteServerPort").val(null);jQuery("#lblReadServerURI").html("");jQuery("#lblWriteServerURI").html("");jQuery("#serverConfigPanel").addClass("hidden");jQuery.unblockUI()});jQuery("#cmdDisconectChanels").click(function(n){n.preventDefault();n.stopPropagation();serverConfig.disconectAllChanels()});jQuery(document).everyTime(500,function(){serverConfig.sendDataForAllServers()});initCanvas()});initCanvas=function(){var n=tools.getCanvasContext();n.fillStyle="blue";n.font="bold 16px Arial";n.fillText("y Axis (numbers)",5,16);n.fillRect(30,30,2,530);n.fillStyle="red";n.fillRect(30,558,890,2);n.fillText("x Axis(seconds)",760,548);buildSeries()};buildSeries=function(){var n=tools.getCanvasContext(),r,u,t,i;for(n.font="10px Arial",r=0,u=53;u>0;u--)r++,n.fillStyle="#EBEBEB",n.fillRect(35,30+r*10,900,1),t=u.toString(),t.length==1&&(t=" "+t),t+="-",n.fillStyle="gray",n.fillText(t,10,30+r*10);for(i=0;i<=60;i++)n.fillText(i.toString(),40+i*14,570)};
//# sourceMappingURL=SumClient.min.js.map
